<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:controls="using:userinterface.Controls"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="userinterface.Controls.EditableExpanderView">

	<UserControl.Styles>
		<!-- Header Button Styling -->
		<Style Selector="controls|NoInteractionButtonView.ExpanderHeader">
			<Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
			<Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="CornerRadius" Value="6"/>
			<Setter Property="Padding" Value="12,8"/>
			<Setter Property="HorizontalAlignment" Value="Stretch"/>
			<Setter Property="MinHeight" Value="40"/>
			<Setter Property="Transitions">
				<Transitions>
					<BrushTransition Property="Background" Duration="0:0:0.15"/>
					<BrushTransition Property="BorderBrush" Duration="0:0:0.15"/>
				</Transitions>
			</Setter>
		</Style>

		<!-- Header Button Hover Effect -->
		<Style Selector="controls|NoInteractionButtonView.ExpanderHeader.SyncHover">
			<Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource AccentBorderBrush}"/>
		</Style>

		<!-- Header when expanded -->
		<Style Selector="controls|NoInteractionButtonView.ExpanderHeader.Expanded">
			<Setter Property="CornerRadius" Value="6,6,0,0"/>
			<Setter Property="BorderThickness" Value="1,1,1,0"/>
			<Setter Property="MinHeight" Value="80"/>
		</Style>

		<!-- Header when expanded and hovered -->
		<Style Selector="controls|NoInteractionButtonView.ExpanderHeader.Expanded.SyncHover">
			<Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource AccentBorderBrush}"/>
			<Setter Property="CornerRadius" Value="6,6,0,0"/>
			<Setter Property="BorderThickness" Value="1,1,1,0"/>
		</Style>

		<!-- Content Button Styling -->
		<Style Selector="controls|NoInteractionButtonView.ExpanderContent">
			<Setter Property="Background" Value="{DynamicResource CardBackgroundBrush}"/>
			<Setter Property="Foreground" Value="{DynamicResource PrimaryTextBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
			<Setter Property="BorderThickness" Value="1,0,1,1"/>
			<Setter Property="CornerRadius" Value="0,0,6,6"/>
			<Setter Property="Padding" Value="12"/>
			<Setter Property="HorizontalAlignment" Value="Stretch"/>
			<Setter Property="Transitions">
				<Transitions>
					<BrushTransition Property="Background" Duration="0:0:0.15"/>
					<BrushTransition Property="BorderBrush" Duration="0:0:0.15"/>
				</Transitions>
			</Setter>
		</Style>

		<!-- Content Button Hover Effect - maintains border connection -->
		<Style Selector="controls|NoInteractionButtonView.ExpanderContent.SyncHover">
			<Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource AccentBorderBrush}"/>
			<Setter Property="BorderThickness" Value="1,0,1,1"/>
			<Setter Property="CornerRadius" Value="0,0,6,6"/>
		</Style>

		<!-- Icon -->
		<Style Selector="PathIcon.ExpandIcon">
			<Setter Property="Width" Value="12"/>
			<Setter Property="Height" Value="12"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
			<Setter Property="Margin" Value="0,4,8,0"/>
			<Setter Property="Transitions">
				<Transitions>
					<DoubleTransition Property="RotateTransform.Angle" Duration="0:0:0.2"/>
				</Transitions>
			</Setter>
		</Style>
	</UserControl.Styles>

	<StackPanel Orientation="Vertical">
		<controls:NoInteractionButtonView Classes="ExpanderHeader" 
                                          Name="HeaderButton"
                                          Click="ToggleButton_Click"
                                          PointerEntered="HeaderButton_PointerEntered"
                                          PointerExited="HeaderButton_PointerExited">
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="*"/>
				</Grid.ColumnDefinitions>

				<PathIcon Grid.Column="0" Grid.Row="0"
                         Classes="ExpandIcon"
                         Name="ExpandIcon"
                         Data="{StaticResource chevron_right_regular}">
					<PathIcon.RenderTransform>
						<RotateTransform Angle="{Binding Angle, RelativeSource={RelativeSource FindAncestor, AncestorType=controls:EditableExpanderView}}"/>
					</PathIcon.RenderTransform>
				</PathIcon>

				<ContentPresenter Grid.Column="1" Grid.Row="0"
                                Content="{Binding Header, RelativeSource={RelativeSource FindAncestor, AncestorType=controls:EditableExpanderView}}"
                                VerticalAlignment="Center"/>
			</Grid>
		</controls:NoInteractionButtonView>

		<controls:NoInteractionButtonView Classes="ExpanderContent"
                                          Name="ContentButton"
                                          IsVisible="False"
                                          Click="ToggleButton_Click"
                                          PointerEntered="ContentButton_PointerEntered"
                                          PointerExited="ContentButton_PointerExited">
			<ContentPresenter Content="{Binding ExpanderContent, RelativeSource={RelativeSource FindAncestor, AncestorType=controls:EditableExpanderView}}"/>
		</controls:NoInteractionButtonView>
	</StackPanel>
</UserControl>
